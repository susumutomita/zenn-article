---
title: "Autonomeã§Agent Kitã‚’ä½¿ã†"
emoji: "ğŸ¦"
type: "tech"
topics: [Autonome, AgentKit, Docker,TypeScript]
published: true
---

## Autonomeã§Agent Kitã‚’ä½¿ã†

**ã“ã®è¨˜äº‹ã¯2025å¹´2æœˆæ™‚ç‚¹ã®æƒ…å ±ã§ã™ã€‚**
æœ€è¿‘è©±é¡Œã®ã€ŒAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã‚’æ‰‹è»½ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨ã—ã¦æ³¨ç›®ã•ã‚Œã‚‹ã®ãŒ**Autonomeï¼ˆã‚ªãƒ¼ãƒˆãƒãƒ¼ãƒ ï¼‰**ã§ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯ã€Autonomeä¸Šã§Agent Kitã‚’åˆ©ç”¨ã—ã¦
AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

### Autonomeã¨ã¯

**Autonome**ã¯AltLayerç¤¾ãŒæä¾›ã™ã‚‹
è‡ªå¾‹å‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä½œæˆã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã‚ã®
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
Webä¸Šã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç°¡å˜ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ã§ãã€
ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã®æ‰‹é–“ãŒä¸è¦ã§ã™ã€‚

Autonomeã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€é€šå¸¸ã®ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ã‚ˆã†ã«
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å¯¾è©±ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€è‡ªå¾‹çš„ãªåˆ¤æ–­ã‚„
ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã§ã®å‹•ä½œã‚‚å¯èƒ½ã§ã™ã€‚
ä¾‹ãˆã°ã€æ¬¡ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒæƒ³å®šã•ã‚Œã¾ã™ã€‚

- **è‡ªå‹•å–å¼•ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’AIã§åˆ†æã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨±å¯ç¯„å›²å†…ã§æš—å·è³‡ç”£ã®å£²è²·ã‚’è‡ªå¾‹å®Ÿè¡Œã—ã¾ã™ã€‚
- **ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³åˆ†æã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã®å–å¼•ãƒ‡ãƒ¼ã‚¿ã‚„ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ç›£è¦–ã—
  ç•°å¸¸æ¤œçŸ¥ã‚„ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚
- **ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç®¡ç†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  è¤‡æ•°ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜ã‚„NFTã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½è·¡ã—ã€
  æœ€é©ãªè³‡ç”£é…åˆ†ã‚’ææ¡ˆã—ã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«ã€AIã¨ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ã®çµ„ã¿åˆã‚ã›ã¯
2025å¹´ã®æ³¨ç›®ãƒˆãƒ¬ãƒ³ãƒ‰ã§ã™ã€‚
Autonomeã¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œä¿¡é ¼æ€§ã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã€
Trusted Execution Environment (TEE) ã«ã‚ˆã‚Šä¿è­·ã—ã¾ã™ã€‚

ãªãŠã€Autonomeã§ã¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ§‹ç¯‰æ™‚ã«è¤‡æ•°ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é¸æŠã§ãã¾ã™ã€‚
ç¾åœ¨ã¯**AgentKit**ã€Based Agentã€Elizaã€Perplexicaã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯**AgentKit**ã‚’ç”¨ã„ãŸé–‹ç™ºæ–¹æ³•ã«ç„¦ç‚¹ã‚’ã‚ã¦ã¾ã™ã€‚

### Agent Kitã¨ã¯

**Agent Kitï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚­ãƒƒãƒˆï¼‰**ã¯ã€Coinbaseç¤¾ãŒæä¾›ã™ã‚‹
é–‹ç™ºè€…å‘ã‘ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒCoinbase Developer Platform, CDPã€ã®ä¸€éƒ¨ã§ã™ã€‚
AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã§å‹•ä½œã™ã‚‹èƒ½åŠ›ã‚’ä¸ãˆã¾ã™ã€‚

Agent Kitã‚’ä½¿ã†ã¨ã€LLMï¼ˆå¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼‰ã‚’ç”¨ã„ãŸ
ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¬¡ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã¾ã™ã€‚

- **ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œ**
  æš—å·è³‡ç”£ã®è»¢é€ã‚„ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®å®Ÿè¡ŒãŒå¯èƒ½ã§ã™ã€‚
  ä¾‹ã¨ã—ã¦ã€Œã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆETHã‚’é€é‡‘ã—ã¦ã€
  ã¨æŒ‡ç¤ºã™ã‚Œã°è‡ªå‹•ã§é€é‡‘å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚
- **ãƒãƒ«ãƒãƒ¢ãƒ‡ãƒ«å¯¾å¿œ**
  GPT-4/3.5ã ã‘ã§ãªãã€Anthropicã®Claudeã‚„Llamaã‚‚
  åˆ©ç”¨ã§ãã‚‹ãŸã‚ã€ç”¨é€”ã«åˆã£ãŸãƒ¢ãƒ‡ãƒ«ã‚’é¸ã¹ã¾ã™ã€‚
- **ãƒ„ãƒ¼ãƒ«ã®çµ±åˆ**
  Agent Kitã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯éä¾å­˜ã®è¨­è¨ˆã§ã™ã€‚
  LangChainãªã©ã¨çµ±åˆã—ã€æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã«
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ©Ÿèƒ½ã‚’ç°¡å˜ã«è¿½åŠ ã§ãã¾ã™ã€‚
- **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç†**
  å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å›ºæœ‰ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’æŒãŸã›ã¾ã™ã€‚
  CDPã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆAPI/SDKã‚’æ´»ç”¨ã—ã€å®‰å…¨ã«éµç®¡ç†ãŒè¡Œãˆã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«ã€Agent Kitã¯AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ã®ã€Œè…•ã¨è¶³ã€ã‚’ç”Ÿã‚„ã—ã¾ã™ã€‚

å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã¯[coinbase/agentkit](https://github.com/coinbase/agentkit)ã§ã™ã€‚
TypeScriptç‰ˆã¨Pythonç‰ˆãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ãŒã€
æœ¬è¨˜äº‹ã§ã¯TypeScriptç‰ˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
Coinbaseå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è§£èª¬ãƒšãƒ¼ã‚¸ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

### ç’°å¢ƒæ§‹ç¯‰

ã¾ãšã¯æ‰‹å…ƒã®ç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚
æ¬¡ã®ãƒ„ãƒ¼ãƒ«ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æº–å‚™ã—ã¦ãã ã•ã„ã€‚

- **Node.js 18ä»¥ä¸Š**
  Agent Kitï¼ˆTypeScriptç‰ˆï¼‰ã®å®Ÿè¡Œã«ã¯Node.jsãŒå¿…è¦ã§ã™ã€‚
  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒã¾ã ã®å ´åˆã¯ã€å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰LTSç‰ˆã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚
- **Docker**
  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã—ã¦Autonomeã§å‹•ä½œã•ã›ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
  Docker Desktopãªã©ã‚’å°å…¥ã—ã¦ãã ã•ã„ã€‚
- **Docker Hubã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ**
  Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ãŸã‚ã«Docker Hubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚
  ã¾ã ã®å ´åˆã¯[å…¬å¼ã‚µã‚¤ãƒˆ](https://hub.docker.com/)ã‹ã‚‰ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚
- **Git**
  ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†ç”¨ã§ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³æ™‚ã«å¿…è¦ã§ã™ã€‚

ä¸Šè¨˜ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰ã€**Autonomeã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã‚’ä½œæˆã—ã¾ã™ã€‚
å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ([Deploy AI Agent](https://docs.altlayer.io/altlayer-documentation/autonome/deploy-ai-agent#:~:text=1))ã«æ²¿ã£ã¦
ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚

1. **Autonomeã«ãƒ­ã‚°ã‚¤ãƒ³**
   ãƒ–ãƒ©ã‚¦ã‚¶ã§`https://apps.autono.meme/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€
   Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚
   åˆå›ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«çµ„ç¹”åã®ä½œæˆã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã®ã§ã€é©åˆ‡ãªåç§°ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚
2. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ–°è¦ä½œæˆ**
   ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã€Œ+ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€
   æ–°ã—ã„AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
   ã“ã“ã§ã¯å¾Œã»ã©Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚„è¨­å®šã‚’ã—ã¾ã™ã€‚

ã¾ãŸã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‹•ä½œç”¨ã«ä»¥ä¸‹ã®APIã‚­ãƒ¼ã‚‚ç”¨æ„ã—ã¦ãã ã•ã„ã€‚

- **OpenAI APIã‚­ãƒ¼**
  LLMï¼ˆGPT-4/3.5ç­‰ï¼‰åˆ©ç”¨ã®ãŸã‚ã«å¿…è¦ã§ã™ã€‚
- **Coinbase CDP APIã‚­ãƒ¼å**
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œã«ç”¨ã„ã‚‹ç§˜å¯†éµä»˜ãAPIã‚­ãƒ¼ã®åå‰ã§ã™ã€‚
- **Coinbase CDP APIã‚­ãƒ¼**
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œã«ç”¨ã„ã‚‹ç§˜å¯†éµä»˜ãAPIã‚­ãƒ¼ã§ã™ã€‚

### Agent Kitã‚’ä½¿ã„AI Agentã‚’ä½œæˆ

[Quickstart](https://docs.cdp.coinbase.com/agentkit/docs/quickstart#starting-from-scratch-with-langchain)
ã«å¾“ã£ã¦Agentã‚’æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚
ä»Šå›ã¯TypeScriptç‰ˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

#### å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install @coinbase/agentkit @coinbase/agentkit-langchain @langchain/openai @langchain/core @langchain/langgraph viem
```

è¿½åŠ ã§å¿…è¦ãªã‚‚ã®ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚

```bash
pnpm add @types/express @types/node express swagger-jsdoc swagger-ui-express
pnpm add -D @types/swagger-jsdoc @types/swagger-ui-express express prettier ts-node typescript
```

å¿…è¦ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚è¿½åŠ ã—ã¦ãŠãã¾ã™ã€‚

```package.json
{
  "name": "autonome-coinbase-agentkit-integration",
  "version": "1.0.0",
  "description": "",
  "main": "build/index.js",
  "scripts": {
    "start": "node --env-file .env build/index.js",
    "build": "tsc",
    "format": "prettier --write '**/**/*.{js,ts,tsx,css}'",
    "format:check": "prettier --check '**/**/*.{ts,tsx,js,jsx,css}'"
  },
:
}
```

#### ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ã€‚

```.env
CDP_API_KEY_NAME=your-cdp-key-name
CDP_API_KEY_PRIVATE_KEY=your-cdp-private-key
OPENAI_API_KEY=your-openai-key
NETWORK_ID=base-sepolia
DOCKER_USERNAME=your-docker-username # Docker Hubã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½¿ç”¨
```

#### Agentã®ä½œæˆ

Autonomeã§å‹•ã›ã‚‹ã‚ˆã†ã«ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã¨APIçµŒç”±ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```index.ts
import {
  AgentKit,
  CdpWalletProvider,
  wethActionProvider,
  walletActionProvider,
  erc20ActionProvider,
  erc721ActionProvider,
  cdpApiActionProvider,
  cdpWalletActionProvider,
  pythActionProvider,
} from "@coinbase/agentkit";
import { getLangChainTools } from "@coinbase/agentkit-langchain";
import { HumanMessage } from "@langchain/core/messages";
import { MemorySaver } from "@langchain/langgraph";
import { createReactAgent } from "@langchain/langgraph/prebuilt";
import { ChatOpenAI } from "@langchain/openai";
import * as fs from "fs";
import express, { Request, Response } from "express";
import swaggerUi from "swagger-ui-express";
import swaggerJSDoc from "swagger-jsdoc";

// ç’°å¢ƒå¤‰æ•°ã®æ¤œè¨¼
function validateEnvironment(): void {
  const missingVars: string[] = [];
  const requiredVars = [
    "OPENAI_API_KEY",
    "CDP_API_KEY_NAME",
    "CDP_API_KEY_PRIVATE_KEY",
  ];
  requiredVars.forEach((varName) => {
    if (!process.env[varName]) {
      missingVars.push(varName);
    }
  });
  if (missingVars.length > 0) {
    console.error("Missing required environment variables:", missingVars);
    missingVars.forEach((varName) => {
      console.error(`${varName}=your_${varName.toLowerCase()}_here`);
    });
    process.exit(1);
  }
  if (!process.env.NETWORK_ID) {
    console.warn("NETWORK_ID not set, defaulting to base-sepolia");
  }
}

validateEnvironment();

const WALLET_DATA_FILE = "wallet_data.txt";

async function initializeAgent() {
  console.log("Initializing agent...");
  const llm = new ChatOpenAI({ model: "gpt-4o-mini" });
  let walletDataStr: string | null = null;
  if (fs.existsSync(WALLET_DATA_FILE)) {
    try {
      walletDataStr = fs.readFileSync(WALLET_DATA_FILE, "utf8");
      console.log("Wallet data read from file");
    } catch (error) {
      console.error("Error reading wallet data file", error);
    }
  }

  const config = {
    apiKeyName: process.env.CDP_API_KEY_NAME,
    apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
      /\\n/g,
      "\n",
    ),
    cdpWalletData: walletDataStr || undefined,
    networkId: process.env.NETWORK_ID || "base-sepolia",
  };

  const walletProvider = await CdpWalletProvider.configureWithWallet(config);
  console.log("Wallet provider configured");

  const agentkit = await AgentKit.from({
    walletProvider,
    actionProviders: [
      wethActionProvider(),
      pythActionProvider(),
      walletActionProvider(),
      erc20ActionProvider(),
      erc721ActionProvider(),
      cdpApiActionProvider({
        apiKeyName: process.env.CDP_API_KEY_NAME,
        apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
          /\\n/g,
          "\n",
        ),
      }),
      cdpWalletActionProvider({
        apiKeyName: process.env.CDP_API_KEY_NAME,
        apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
          /\\n/g,
          "\n",
        ),
      }),
    ],
  });
  console.log("AgentKit initialized");

  const tools = await getLangChainTools(agentkit);
  const memory = new MemorySaver();
  const agentConfig = {
    configurable: { thread_id: "CDP AgentKit Chatbot" },
  };
  const agent = createReactAgent({
    llm,
    tools,
    checkpointSaver: memory,
    messageModifier: `
      You are a helpful agent that can interact onchain using Coinbase Developer Platform AgentKit.
      If you ever need funds, request them appropriately.
      Be concise and helpful.
    `,
  });
  console.log("Agent created");

  const exportedWallet = await walletProvider.exportWallet();
  fs.writeFileSync(WALLET_DATA_FILE, JSON.stringify(exportedWallet));
  console.log("Wallet data exported and saved");

  return { agent, config: agentConfig };
}

// Swagger ã®è¨­å®š
const swaggerDefinition = {
  openapi: "3.0.0",
  info: {
    title: "Agent API",
    version: "1.0.0",
    description: "API documentation for the Coinbase AgentKit based service",
  },
  servers: [
    {
      url: "http://localhost:3000",
    },
  ],
};

const swaggerOptions = {
  swaggerDefinition,
  apis: ["./src/index.ts"],
};

const swaggerSpec = swaggerJSDoc(swaggerOptions);

async function startAgentServer() {
  const app = express();
  const port = Number(process.env.PORT) || 3000;
  app.use(express.json());

  // Swagger UI ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  app.use("/api-docs", swaggerUi.serve, swaggerUi.setup(swaggerSpec));

  /**
   * @swagger
   * /message:
   *   post:
   *     summary: Chat with the agent
   *     description: Sends a text message to the agent and returns its response.
   *     requestBody:
   *       required: true
   *       content:
   *         application/json:
   *           schema:
   *             type: object
   *             required:
   *               - message
   *             properties:
   *               message:
   *                 type: string
   *                 example: "Hello, Agent!"
   *     responses:
   *       200:
   *         description: Agent response
   *         content:
   *           application/json:
   *             schema:
   *               type: object
   *               properties:
   *                 text:
   *                   type: string
   *                   example: "This is the agent's response."
   *       400:
   *         description: Bad request
   *       500:
   *         description: Internal server error
   */
  app.post("/message", async (req: Request, res: Response) => {
    const { message } = req.body;
    if (!message || typeof message !== "string") {
      console.error("Invalid request", req.body);
      return res
        .status(400)
        .json({ error: "Invalid request: 'message' field is required." });
    }
    if (message === "healthz") {
      return res.status(200).json({ status: "ok" });
    }
    console.log("Processing chat request:", message);
    try {
      const { agent, config } = await initializeAgent();
      const stream = await agent.stream(
        { messages: [new HumanMessage(message)] },
        config,
      );
      let fullResponse = "";
      for await (const chunk of stream) {
        if (
          "agent" in chunk &&
          chunk.agent.messages &&
          chunk.agent.messages[0]
        ) {
          fullResponse += chunk.agent.messages[0].content;
        }
      }
      console.log("Agent response:", fullResponse);
      res.json({ text: fullResponse });
    } catch (error) {
      console.error("Error processing chat request", error);
      res.status(500).json({ error: "Internal server error" });
    }
  });

  app.listen(port, "0.0.0.0", () => {
    console.log(`Agent REST server is listening on port ${port}`);
    console.log(`Swagger UI available at http://localhost:${port}/api-docs`);
  });
}

if (require.main === module) {
  startAgentServer().catch((error) => {
    console.error("Failed to start agent server:", error);
    process.exit(1);
  });
}
```

#### Agentã®èµ·å‹•ç¢ºèª

```bash
â¯ pnpm run build && pnpm run start

> autonome-coinbase-agentkit-integration@1.0.0 build /Users/susumu/autonome-coinbase-agentkit-integration
> tsc


> autonome-coinbase-agentkit-integration@1.0.0 start /Users/susumu/autonome-coinbase-agentkit-integration
> node --env-file .env build/index.js

(node:3727) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
Agent REST server is listening on port 3000
Swagger UI available at http://localhost:3000/api-docs
```

ã“ã‚Œã§Agent Kitã‚’ä½¿ã£ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒèµ·å‹•ã—ã¾ã—ãŸã€‚
Swagger UIã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è©¦ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

## Autonomeã§å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

Autonomeã§å‹•ã‹ã™ã«ã¯ä»¥ä¸‹ã®ä½œæ¥­ãŒå¿…è¦ã§ã—ãŸã€‚

1. linux/amd64ã«å¯¾å¿œã—ãŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ
2. APIçµŒç”±ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹(å®Ÿè£…æ¸ˆã¿)
3. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®è¿½åŠ (healthzã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ã‚‰ã‚Œã¦ãã¾ã™ã€‚ã“ã‚Œã‚‚å®Ÿè£…æ¸ˆã¿)

æ®‹ã‚Šã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆã—ã¾ã™ã€‚

### linux/amd64ã«å¯¾å¿œã—ãŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ

#### docker-entrypoint.shã®ä½œæˆ

ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«`docker-entrypoint.sh`ã‚’ä½œæˆã—ã¾ã™ã€‚

```docker-entrypoint.sh
#!/bin/sh
set -e
exec "$@"
```

#### Dockerfileã®ä½œæˆ

ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«`Dockerfile`ã‚’ä½œæˆã—ã¾ã™ã€‚
ãƒã‚¤ãƒ³ãƒˆã¯/usr/local/bin/docker-entrypoint.shã¸ã®é…ç½®ã§ã™ã€‚

```Dockerfile
FROM node:23

WORKDIR /app

RUN npm install -g pnpm

# Copy package files (if needed for runtime scripts)
COPY package*.json ./

# Install production dependencies only
RUN pnpm install

COPY . .

RUN pnpm run build
# Copy entrypoint script and set execution permissions
COPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh
RUN chmod +x /usr/local/bin/docker-entrypoint.sh

# Set production environment variables
ENV NODE_ENV=production
ENV DAEMON_PROCESS=true
ENV SERVER_PORT=3000

# Set entrypoint and command:
ENTRYPOINT ["/usr/local/bin/docker-entrypoint.sh"]
CMD ["node", "build/index.js"]
```

ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ãƒ—ãƒƒã‚·ãƒ¥ç”¨ã®Makefileã‚‚ä½œæˆã—ã¾ã™ã€‚

```Makefile
# Load .env file if available (.env should contain KEY=VALUE pairs)
-include .env

# Retrieve DOCKER_USERNAME from the environment (error out if not set)
ifndef DOCKER_USERNAME
$(error DOCKER_USERNAME is not set. Please set it in your environment or in a .env file)
endif

# Docker related variables
IMAGE_NAME = autonome-coinbase-agentkit-integration
TAG ?= latest

# Full image name with tag
DOCKER_IMAGE = $(DOCKER_USERNAME)/$(IMAGE_NAME):$(TAG)

.PHONY: build
build:
	docker build --platform linux/amd64 -t $(DOCKER_IMAGE) .

.PHONY: push
push:
	@if ! docker images | grep -q $(DOCKER_IMAGE); then \
		$(MAKE) build; \
	fi
	docker push $(DOCKER_IMAGE)

.PHONY: all
all: build push

.PHONY: help
help:
	@echo "Available commands:"
	@echo "  make build    - Build the Docker image (targeting linux/amd64)"
	@echo "  make push     - Push the image to DockerHub (build automatically if image is not found)"
	@echo "  make all      - Build and push the image"
	@echo ""
	@echo "Environment variable settings:"
	@echo "  DOCKER_USERNAME    - Your DockerHub username (do not hardcode sensitive information)"
	@echo "  TAG                - Image tag (default: latest)"
```

`make all`ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§linux/amd64ç”¨ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨Docker Hubã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ãŒè¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã•ã‚‰ã«åˆã‚ã›ã¦ãƒ†ã‚¹ãƒˆç”¨ã«docker runã‚’è¡Œã†ãŸã‚ã®`docker-compose.yml`ã‚‚ä½œæˆã—ã¾ã™ã€‚

```docker-compose.yml
services:
  autonome-coinbase-agentkit-integration:
    image: ${DOCKER_USERNAME}/autonome-coinbase-agentkit-integration:latest
    platform: linux/amd64
    environment:
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      CDP_API_KEY_NAME: ${CDP_API_KEY_NAME}
      CDP_API_KEY_PRIVATE_KEY: ${CDP_API_KEY_PRIVATE_KEY}
      NETWORK_ID: ${NETWORK_ID:-base-sepolia}
    ports:
      - "3000:3000"
    stdin_open: true
    tty: true
```

ã“ã‚Œã§ã€Docker Hubã«ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```bash
docker compose up
```

ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒèµ·å‹•ã—ãŸã‚‰æˆåŠŸã§ã™ã€‚

## Autonomeã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

### Frame Workã®ä½œæˆ

ã¾ãšä»Šå›ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Autonomeã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

Autonomeã«ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ãŸã‚‰[Upload your framework](https://dev.autonome.fun/autonome/publish)ã‚’é¸æŠã—ã¾ã™ã€‚

ãƒ•ã‚©ãƒ¼ãƒ ã«å¿…è¦é …ç›®ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

```text
Name: ä»»æ„ã®åå‰
DESCRIPTION: ä»»æ„ã®èª¬æ˜
DOCKER IMAGE: ä½œæˆã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã®URL
AGENT LOGO: ä»»æ„ã®ç”»åƒ
CAHT EDNPOINT: ä»»æ„ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä»Šå›ã®å ´åˆã ã¨/message
PORT: 3000
CHAT REQUEST SCHEMA: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾
CHAT RESPONSE SCHEMA: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾
GITHUB URL: ä»»æ„ã®URL
SPECIFY ENVIRONMENT VARIABLES: ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š

- OPENAI_API_KEY
- CDP_API_KEY_NAME
- CDP_API_KEY_PRIVATE_KEY
- NETWORK_ID
```

ã“ã‚Œã‚‰ã‚’å…¥åŠ›ã—ãŸã‚‰Submitã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

## Deploy

https://dev.autonome.fun/autonome/new
ã«ç§»å‹•ã—ã¦
Select a template -> UPLOADã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»Šå›ä½œæˆã—ãŸãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é¸æŠã—ã¾ã™ã€‚
AGENT PREFIX NAME: ä»»æ„ã®åå‰
ã‚’å…¥åŠ›ã—ã¦Submitã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

ç’°å¢ƒå¤‰æ•°ã«å€¤ã‚’è¨­å®šã—ã¦Confirm
ãã®å¾Œã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®é¸æŠãŒã‚ã‚Šã¾ã™ãŒfree trialã‚‚ã—ãã¯Promo codeã‚’[Google Form](https://forms.gle/gXWvdVBoxEchu2gp6)ã‹ã‚‰å…¥æ‰‹ã—ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

ã“ã‚Œã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

### ãƒ‡ãƒ—ãƒ­ã‚¤ã®ç¢ºèª

2025/2æ™‚ç‚¹ã§ã¯ãƒ™ãƒ¼ã‚·ãƒƒã‚¯èªè¨¼ã‚’ä½¿ã£ã¦ã„ã‚‹ãŸã‚ã€ãƒ™ãƒ¼ã‚·ãƒƒã‚¯èªè¨¼ã®ãƒ˜ãƒƒãƒ€ã‚’ä»˜ä¸ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

å…·ä½“çš„ãªã‚„ã‚Šæ–¹ã¯[API guide](https://docs.google.com/document/d/1k9AXoY8Yljw_I_yS3arnALfytqKQiSMfZaYX6GI71qk/edit?tab=t.0)ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ä¾‹ã€‚

```bash
curl --location --request POST 'https://autonome.alt.technology/<Project Name>/message' \
--header 'Content-Type: application/json' \
--header 'Authorization: Basic <BASIC èªè¨¼>' \
--data '{
    "message": "hi"
}'

{"text":"Hello! How can I assist you today?"}
```

ã®ã‚ˆã†ã«å¿œç­”ãŒè¿”ã£ã¦ãã¾ã™ã€‚

## ãƒãƒã£ãŸãƒã‚¤ãƒ³ãƒˆã¨å›é¿ç­–

æœ€å¾Œã«ã€ç­†è€…ãŒå®Ÿéš›ã«Autonomeï¼‹AgentKitç’°å¢ƒã‚’è§¦ã£ã¦ã¿ã¦ãƒãƒã£ãŸãƒã‚¤ãƒ³ãƒˆã¨ãã®å›é¿ç­–ã‚’å…±æœ‰ã—ã¾ã™ã€‚

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

Autonomeã§ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã®ç¨¼åƒç›£è¦–ã®ãŸã‚ã«healthzã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚Šãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦ã™ãã«200ã‚’è¿”ã™å®Ÿè£…ã«ã—ã¦ãã ã•ã„ã€‚

### exec /usr/local/bin/docker-entrypoint.sh: exec format error`

Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸­ã«docker-entrypoint.shã‚’é…ç½®ã—ã¦ã‚ã’ã¦0ãªã‚Šã‚’ãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### Apple Silicon Macã§ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰

Apple Siliconã®Macã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚‚Autonomeä¸Šã§å‹•ã‹ãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚docker build --platform linux/amd64 -t <ã‚¿ã‚°å> .ã¨ã—ã¦ä¸Šã’ã‚‹ã¨å›é¿ã§ãã¾ã™ã€‚

## ã‚³ãƒ¼ãƒ‰ã¨å‚è€ƒãƒªãƒ³ã‚¯

### ã‚³ãƒ¼ãƒ‰

æœ€å¾Œã«ã€ä»Šå›è§£èª¬ã—ãŸã‚³ãƒ¼ãƒ‰ä¸€å¼ã¯GitHubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚ã‚Šã¾ã™ [autonome-coinbase-agentkit-integration](https://github.com/susumutomita/autonome-coinbase-agentkit-integration)

#### å‚è€ƒãƒªãƒ³ã‚¯é›†

- [AltLayerå…¬å¼: Autonomeãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.altlayer.io/altlayer-documentation/autonome/deploy-ai-agent)
- [Introducing AgentKit | Coinbase](https://www.coinbase.com/developer-platform/discover/launches/introducing-agentkit)
- [Coinbase Developer Docs: AgentKit](https://docs.cdp.coinbase.com/agentkit/docs/welcome)
- [Coinbase GitHub](https://github.com/coinbase/agentkit)
