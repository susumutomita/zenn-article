---
title: "Autonomeã§Agent Kitã‚’ä½¿ã†"
emoji: "ğŸ¦"
type: "tech"
topics: [Autonome, AgentKit, Docker]
published: false
---

## Autonomeã§Agent Kitã‚’ä½¿ã†

**ã“ã®è¨˜äº‹ã¯2025å¹´2æœˆæ™‚ç‚¹ã®æƒ…å ±ã§ã™ã€‚**
æœ€è¿‘è©±é¡Œã®ã€ŒAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã‚’æ‰‹è»½ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨ã—ã¦æ³¨ç›®ã•ã‚Œã‚‹ã®ãŒ**Autonomeï¼ˆã‚ªãƒ¼ãƒˆãƒãƒ¼ãƒ ï¼‰**ã§ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯ã€Autonomeä¸Šã§Agent Kitã‚’åˆ©ç”¨ã—ã¦
AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

### Autonomeã¨ã¯

**Autonome**ã¯AltLayerç¤¾ãŒæä¾›ã™ã‚‹
è‡ªå¾‹å‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä½œæˆã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã‚ã®
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
Webä¸Šã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç°¡å˜ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ã§ãã€
ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã®æ‰‹é–“ãŒä¸è¦ã§ã™ã€‚

Autonomeã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€é€šå¸¸ã®ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ã‚ˆã†ã«
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å¯¾è©±ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€è‡ªå¾‹çš„ãªåˆ¤æ–­ã‚„
ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã§ã®å‹•ä½œã‚‚å¯èƒ½ã§ã™ã€‚
ä¾‹ãˆã°ã€æ¬¡ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒæƒ³å®šã•ã‚Œã¾ã™ã€‚

- **è‡ªå‹•å–å¼•ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’AIã§åˆ†æã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨±å¯ç¯„å›²å†…ã§æš—å·è³‡ç”£ã®å£²è²·ã‚’è‡ªå¾‹å®Ÿè¡Œã—ã¾ã™ã€‚
- **ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³åˆ†æã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã®å–å¼•ãƒ‡ãƒ¼ã‚¿ã‚„ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ç›£è¦–ã—
  ç•°å¸¸æ¤œçŸ¥ã‚„ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚
- **ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç®¡ç†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  è¤‡æ•°ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜ã‚„NFTã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½è·¡ã—ã€
  æœ€é©ãªè³‡ç”£é…åˆ†ã‚’ææ¡ˆã—ã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«ã€AIã¨ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ã®çµ„ã¿åˆã‚ã›ã¯
2025å¹´ã®æ³¨ç›®ãƒˆãƒ¬ãƒ³ãƒ‰ã§ã™ã€‚
Autonomeã¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œä¿¡é ¼æ€§ã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã€
Trusted Execution Environment (TEE) ã«ã‚ˆã‚Šä¿è­·ã—ã¾ã™ã€‚

ãªãŠã€Autonomeã§ã¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ§‹ç¯‰æ™‚ã«è¤‡æ•°ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é¸æŠã§ãã¾ã™ã€‚
ç¾åœ¨ã¯**AgentKit**ã€Based Agentã€Elizaã€Perplexicaã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯**AgentKit**ã‚’ç”¨ã„ãŸé–‹ç™ºæ–¹æ³•ã«ç„¦ç‚¹ã‚’ã‚ã¦ã¾ã™ã€‚

### Agent Kitã¨ã¯

**Agent Kitï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚­ãƒƒãƒˆï¼‰**ã¯ã€Coinbaseç¤¾ãŒæä¾›ã™ã‚‹
é–‹ç™ºè€…å‘ã‘ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒCoinbase Developer Platform, CDPã€ã®ä¸€éƒ¨ã§ã™ã€‚
AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ä¸Šã§å‹•ä½œã™ã‚‹èƒ½åŠ›ã‚’ä¸ãˆã¾ã™ã€‚

Agent Kitã‚’ä½¿ã†ã¨ã€LLMï¼ˆå¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼‰ã‚’ç”¨ã„ãŸ
ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¬¡ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã¾ã™ã€‚

- **ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œ**
  æš—å·è³‡ç”£ã®è»¢é€ã‚„ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®å®Ÿè¡ŒãŒå¯èƒ½ã§ã™ã€‚
  ä¾‹ã¨ã—ã¦ã€Œã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆETHã‚’é€é‡‘ã—ã¦ã€
  ã¨æŒ‡ç¤ºã™ã‚Œã°è‡ªå‹•ã§é€é‡‘å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚
- **ãƒãƒ«ãƒãƒ¢ãƒ‡ãƒ«å¯¾å¿œ**
  GPT-4/3.5ã ã‘ã§ãªãã€Anthropicã®Claudeã‚„Llamaã‚‚
  åˆ©ç”¨ã§ãã‚‹ãŸã‚ã€ç”¨é€”ã«åˆã£ãŸãƒ¢ãƒ‡ãƒ«ã‚’é¸ã¹ã¾ã™ã€‚
- **ãƒ„ãƒ¼ãƒ«ã®çµ±åˆ**
  Agent Kitã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯éä¾å­˜ã®è¨­è¨ˆã§ã™ã€‚
  LangChainãªã©ã¨çµ±åˆã—ã€æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã«
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ©Ÿèƒ½ã‚’ç°¡å˜ã«è¿½åŠ ã§ãã¾ã™ã€‚
- **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç†**
  å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å›ºæœ‰ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’æŒãŸã›ã¾ã™ã€‚
  CDPã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆAPI/SDKã‚’æ´»ç”¨ã—ã€å®‰å…¨ã«éµç®¡ç†ãŒè¡Œãˆã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«ã€Agent Kitã¯AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ã‚¤ãƒ³ã®ã€Œè…•ã¨è¶³ã€ã‚’ç”Ÿã‚„ã—ã¾ã™ã€‚

å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã¯[coinbase/agentkit](https://github.com/coinbase/agentkit)ã§ã™ã€‚
TypeScriptç‰ˆã¨Pythonç‰ˆãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ãŒã€
æœ¬è¨˜äº‹ã§ã¯TypeScriptç‰ˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
Coinbaseå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è§£èª¬ãƒšãƒ¼ã‚¸ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

### ç’°å¢ƒæ§‹ç¯‰

ã¾ãšã¯æ‰‹å…ƒã®ç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚
æ¬¡ã®ãƒ„ãƒ¼ãƒ«ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æº–å‚™ã—ã¦ãã ã•ã„ã€‚

- **Node.js 18ä»¥ä¸Š**
  Agent Kitï¼ˆTypeScriptç‰ˆï¼‰ã®å®Ÿè¡Œã«ã¯Node.jsãŒå¿…è¦ã§ã™ã€‚
  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒã¾ã ã®å ´åˆã¯ã€å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰LTSç‰ˆã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚
- **Docker**
  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã—ã¦Autonomeã§å‹•ä½œã•ã›ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
  Docker Desktopãªã©ã‚’å°å…¥ã—ã¦ãã ã•ã„ã€‚
- **Docker Hubã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ**
  Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ãŸã‚ã«Docker Hubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚
  ã¾ã ã®å ´åˆã¯[å…¬å¼ã‚µã‚¤ãƒˆ](https://hub.docker.com/)ã‹ã‚‰ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚
- **Git**
  ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†ç”¨ã§ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³æ™‚ã«å¿…è¦ã§ã™ã€‚

ä¸Šè¨˜ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰ã€**Autonomeã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã‚’ä½œæˆã—ã¾ã™ã€‚
å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ([Deploy AI Agent](https://docs.altlayer.io/altlayer-documentation/autonome/deploy-ai-agent#:~:text=1))ã«æ²¿ã£ã¦
ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚

1. **Autonomeã«ãƒ­ã‚°ã‚¤ãƒ³**
   ãƒ–ãƒ©ã‚¦ã‚¶ã§`https://apps.autono.meme/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€
   Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚
   åˆå›ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«çµ„ç¹”åã®ä½œæˆã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã®ã§ã€é©åˆ‡ãªåç§°ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚
2. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ–°è¦ä½œæˆ**
   ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã€Œ+ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€
   æ–°ã—ã„AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
   ã“ã“ã§ã¯å¾Œã»ã©Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚„è¨­å®šã‚’ã—ã¾ã™ã€‚

ã¾ãŸã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‹•ä½œç”¨ã«ä»¥ä¸‹ã®APIã‚­ãƒ¼ã‚‚ç”¨æ„ã—ã¦ãã ã•ã„ã€‚

- **OpenAI APIã‚­ãƒ¼**
  LLMï¼ˆGPT-4/3.5ç­‰ï¼‰åˆ©ç”¨ã®ãŸã‚ã«å¿…è¦ã§ã™ã€‚
- **Coinbase CDP APIã‚­ãƒ¼å**
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œã«ç”¨ã„ã‚‹ç§˜å¯†éµä»˜ãAPIã‚­ãƒ¼ã®åå‰ã§ã™ã€‚
- **Coinbase CDP APIã‚­ãƒ¼**
  ã‚ªãƒ³ãƒã‚§ã‚¤ãƒ³æ“ä½œã«ç”¨ã„ã‚‹ç§˜å¯†éµä»˜ãAPIã‚­ãƒ¼ã§ã™ã€‚

### Agent Kitã‚’ä½¿ã„AI Agentã‚’ä½œæˆ

[Quickstart](https://docs.cdp.coinbase.com/agentkit/docs/quickstart#starting-from-scratch-with-langchain)
ã«å¾“ã£ã¦Agentã‚’æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚
ä»Šå›ã¯TypeScriptç‰ˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

#### å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install @coinbase/agentkit @coinbase/agentkit-langchain @langchain/openai @langchain/core @langchain/langgraph viem
```

#### ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```.env
CDP_API_KEY_NAME=your-cdp-key-name
CDP_API_KEY_PRIVATE_KEY=your-cdp-private-key
OPENAI_API_KEY=your-openai-key
NETWORK_ID=base-sepolia
DOCKER_USERNAME=your-docker-username # Docker Hubã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½¿ç”¨
```

#### Agentã®ä½œæˆ

```agent.ts
import {
  AgentKit,
  CdpWalletProvider,
  wethActionProvider,
  walletActionProvider,
  erc20ActionProvider,
  cdpApiActionProvider,
  cdpWalletActionProvider,
  pythActionProvider,
} from "@coinbase/agentkit";

import { getLangChainTools } from "@coinbase/agentkit-langchain";
import { HumanMessage } from "@langchain/core/messages";
import { MemorySaver } from "@langchain/langgraph";
import { createReactAgent } from "@langchain/langgraph/prebuilt";
import { ChatOpenAI } from "@langchain/openai";

import * as fs from "fs";
import * as readline from "readline";

/**
 * Validates that required environment variables are set
 *
 * @throws {Error} - If required environment variables are missing
 * @returns {void}
 */
function validateEnvironment(): void {
  const missingVars: string[] = [];

  // Check required variables
  const requiredVars = [
    "OPENAI_API_KEY",
    "CDP_API_KEY_NAME",
    "CDP_API_KEY_PRIVATE_KEY",
  ];
  requiredVars.forEach((varName) => {
    if (!process.env[varName]) {
      missingVars.push(varName);
    }
  });

  // Exit if any required variables are missing
  if (missingVars.length > 0) {
    console.error("Error: Required environment variables are not set");
    missingVars.forEach((varName) => {
      console.error(`${varName}=your_${varName.toLowerCase()}_here`);
    });
    process.exit(1);
  }

  // Warn about optional NETWORK_ID
  if (!process.env.NETWORK_ID) {
    console.warn(
      "Warning: NETWORK_ID not set, defaulting to base-sepolia testnet",
    );
  }
}

// Add this right after imports and before any other code
validateEnvironment();

// Configure a file to persist the agent's CDP MPC Wallet Data
const WALLET_DATA_FILE = "wallet_data.txt";

/**
 * Initialize the agent with CDP Agentkit
 *
 * @returns Agent executor and config
 */
async function initializeAgent() {
  try {
    // Initialize LLM
    const llm = new ChatOpenAI({
      model: "gpt-4o-mini",
    });

    let walletDataStr: string | null = null;

    // Read existing wallet data if available
    if (fs.existsSync(WALLET_DATA_FILE)) {
      try {
        walletDataStr = fs.readFileSync(WALLET_DATA_FILE, "utf8");
      } catch (error) {
        console.error("Error reading wallet data:", error);
        // Continue without wallet data
      }
    }

    // Configure CDP Wallet Provider
    const config = {
      apiKeyName: process.env.CDP_API_KEY_NAME,
      apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
        /\\n/g,
        "\n",
      ),
      cdpWalletData: walletDataStr || undefined,
      networkId: process.env.NETWORK_ID || "base-sepolia",
    };

    const walletProvider = await CdpWalletProvider.configureWithWallet(config);

    // Initialize AgentKit
    const agentkit = await AgentKit.from({
      walletProvider,
      actionProviders: [
        wethActionProvider(),
        pythActionProvider(),
        walletActionProvider(),
        erc20ActionProvider(),
        cdpApiActionProvider({
          apiKeyName: process.env.CDP_API_KEY_NAME,
          apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
            /\\n/g,
            "\n",
          ),
        }),
        cdpWalletActionProvider({
          apiKeyName: process.env.CDP_API_KEY_NAME,
          apiKeyPrivateKey: process.env.CDP_API_KEY_PRIVATE_KEY?.replace(
            /\\n/g,
            "\n",
          ),
        }),
      ],
    });

    const tools = await getLangChainTools(agentkit);

    // Store buffered conversation history in memory
    const memory = new MemorySaver();
    const agentConfig = {
      configurable: { thread_id: "CDP AgentKit Chatbot Example!" },
    };

    // Create React Agent using the LLM and CDP AgentKit tools
    const agent = createReactAgent({
      llm,
      tools,
      checkpointSaver: memory,
      messageModifier: `
        You are a helpful agent that can interact onchain using the Coinbase Developer Platform AgentKit. You are
        empowered to interact onchain using your tools. If you ever need funds, you can request them from the
        faucet if you are on network ID 'base-sepolia'. If not, you can provide your wallet details and request
        funds from the user. Before executing your first action, get the wallet details to see what network
        you're on. If there is a 5XX (internal) HTTP error code, ask the user to try again later. If someone
        asks you to do something you can't do with your currently available tools, you must say so, and
        encourage them to implement it themselves using the CDP SDK + Agentkit, recommend they go to
        docs.cdp.coinbase.com for more information. Be concise and helpful with your responses. Refrain from
        restating your tools' descriptions unless it is explicitly requested.
        `,
    });

    // Save wallet data
    const exportedWallet = await walletProvider.exportWallet();
    fs.writeFileSync(WALLET_DATA_FILE, JSON.stringify(exportedWallet));

    return { agent, config: agentConfig };
  } catch (error) {
    console.error("Failed to initialize agent:", error);
    throw error; // Re-throw to be handled by caller
  }
}

/**
 * Run the agent autonomously with specified intervals
 */
async function runAutonomousMode(agent: any, config: any, interval = 10) {
  console.log("Starting autonomous mode...");

  while (true) {
    try {
      const thought =
        "Be creative and do something interesting on the blockchain. " +
        "Choose an action or set of actions and execute it that highlights your abilities.";

      const stream = await agent.stream(
        { messages: [new HumanMessage(thought)] },
        config,
      );

      for await (const chunk of stream) {
        if ("agent" in chunk) {
          console.log(chunk.agent.messages[0].content);
        } else if ("tools" in chunk) {
          console.log(chunk.tools.messages[0].content);
        }
        console.log("-------------------");
      }

      await new Promise((resolve) => setTimeout(resolve, interval * 1000));
    } catch (error) {
      if (error instanceof Error) {
        console.error("Error:", error.message);
      }
      process.exit(1);
    }
  }
}

/**
 * Run the agent interactively based on user input
 */
async function runChatMode(agent: any, config: any) {
  console.log("Starting chat mode... Type 'exit' to end.");

  const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
  });

  const question = (prompt: string): Promise<string> =>
    new Promise((resolve) => rl.question(prompt, resolve));

  try {
    while (true) {
      const userInput = await question("\nPrompt: ");

      if (userInput.toLowerCase() === "exit") {
        break;
      }

      const stream = await agent.stream(
        { messages: [new HumanMessage(userInput)] },
        config,
      );

      for await (const chunk of stream) {
        if ("agent" in chunk) {
          console.log(chunk.agent.messages[0].content);
        } else if ("tools" in chunk) {
          console.log(chunk.tools.messages[0].content);
        }
        console.log("-------------------");
      }
    }
  } catch (error) {
    if (error instanceof Error) {
      console.error("Error:", error.message);
    }
    process.exit(1);
  } finally {
    rl.close();
  }
}

/**
 * Choose whether to run in autonomous or chat mode
 */
async function chooseMode(): Promise<"chat" | "auto"> {
  const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
  });

  const question = (prompt: string): Promise<string> =>
    new Promise((resolve) => rl.question(prompt, resolve));

  while (true) {
    console.log("\nAvailable modes:");
    console.log("1. chat    - Interactive chat mode");
    console.log("2. auto    - Autonomous action mode");

    const choice = (await question("\nChoose a mode (enter number or name): "))
      .toLowerCase()
      .trim();

    if (choice === "1" || choice === "chat") {
      rl.close();
      return "chat";
    } else if (choice === "2" || choice === "auto") {
      rl.close();
      return "auto";
    }
    console.log("Invalid choice. Please try again.");
  }
}

/**
 * Main entry point
 */
async function main() {
  try {
    const { agent, config } = await initializeAgent();
    const mode = await chooseMode();

    if (mode === "chat") {
      await runChatMode(agent, config);
    } else {
      await runAutonomousMode(agent, config);
    }
  } catch (error) {
    if (error instanceof Error) {
      console.error("Error:", error.message);
    }
    process.exit(1);
  }
}

// Start the agent when running directly
if (require.main === module) {
  console.log("Starting Agent...");
  main().catch((error) => {
    console.error("Fatal error:", error);
    process.exit(1);
  });
}
```

#### Agentã®èµ·å‹•ç¢ºèª

```bash
â¯ pnpm run start

> autonome-coinbase-agentkit-integration@1.0.0 start /Users/susumu/autonome-coinbase-agentkit-integration
> node --env-file .env build/index.js

Starting Agent...
(node:10522) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)

Available modes:
1. chat    - Interactive chat mode
2. auto    - Autonomous action mode

Choose a mode (enter number or name): 1
Starting chat mode... Type 'exit' to end.

Prompt: hi
Hello! How can I assist you today?
```

ã“ã‚Œã§Agent Kitã‚’ä½¿ã£ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒèµ·å‹•ã—ã¾ã—ãŸã€‚

## Autonomeã§å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

Autonomeã§å‹•ã‹ã™ã«ã¯ä»¥ä¸‹ã®ä½œæ¥­ãŒå¿…è¦ã§ã—ãŸã€‚

1. linux/amd64ã«å¯¾å¿œã—ãŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ
2. APIçµŒç”±ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
3. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®è¿½åŠ 

### linux/amd64ã«å¯¾å¿œã—ãŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ

#### docker-entrypoint.shã®ä½œæˆ

ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«`docker-entrypoint.sh`ã‚’ä½œæˆã—ã¾ã™ã€‚

```docker-entrypoint.sh
#!/bin/sh
set -e
exec "$@"
```

#### Dockerfileã®ä½œæˆ

ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«`Dockerfile`ã‚’ä½œæˆã—ã¾ã™ã€‚
ãƒã‚¤ãƒ³ãƒˆã¯/usr/local/bin/docker-entrypoint.shã¸ã®é…ç½®ã§ã™ã€‚

```Dockerfile
FROM node:23

WORKDIR /app

RUN npm install -g pnpm

# Copy package files (if needed for runtime scripts)
COPY package*.json ./

# Install production dependencies only
RUN pnpm install

COPY . .

RUN pnpm run build
# Copy entrypoint script and set execution permissions
COPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh
RUN chmod +x /usr/local/bin/docker-entrypoint.sh

# Set production environment variables
ENV NODE_ENV=production
ENV DAEMON_PROCESS=true
ENV SERVER_PORT=3000

# Set entrypoint and command:
ENTRYPOINT ["/usr/local/bin/docker-entrypoint.sh"]
CMD ["node", "build/index.js"]
```

åˆã‚ã›ã¦ãƒ†ã‚¹ãƒˆç”¨ã«docker runã‚’è¡Œã†ãŸã‚ã®`docker-compose.yml`ã‚‚ä½œæˆã—ã¾ã™ã€‚

```docker-compose.yml
services:
  autonome-coinbase-agentkit-integration:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      CDP_API_KEY_NAME: ${CDP_API_KEY_NAME}
      CDP_API_KEY_PRIVATE_KEY: ${CDP_API_KEY_PRIVATE_KEY}
      NETWORK_ID: ${NETWORK_ID:-base-sepolia}
    ports:
      - "3000:3000"
    stdin_open: true
    tty: true
```

ã¾ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ãƒ—ãƒƒã‚·ãƒ¥ç”¨ã®Makefileã‚‚ä½œæˆã—ã¾ã™ã€‚

```Makefile
# Load .env file if available (.env should contain KEY=VALUE pairs)
-include .env

# Retrieve DOCKER_USERNAME from the environment (error out if not set)
ifndef DOCKER_USERNAME
$(error DOCKER_USERNAME is not set. Please set it in your environment or in a .env file)
endif

# Docker related variables
IMAGE_NAME = autonome-coinbase-agentkit-integration
TAG ?= latest

# Full image name with tag
DOCKER_IMAGE = $(DOCKER_USERNAME)/$(IMAGE_NAME):$(TAG)

.PHONY: build
build:
	docker build --platform linux/amd64 -t $(DOCKER_IMAGE) .

.PHONY: push
push:
	@if ! docker images | grep -q $(DOCKER_IMAGE); then \
		$(MAKE) build; \
	fi
	docker push $(DOCKER_IMAGE)

.PHONY: all
all: build push

.PHONY: help
help:
	@echo "Available commands:"
	@echo "  make build    - Build the Docker image (targeting linux/amd64)"
	@echo "  make push     - Push the image to DockerHub (build automatically if image is not found)"
	@echo "  make all      - Build and push the image"
	@echo ""
	@echo "Environment variable settings:"
	@echo "  DOCKER_USERNAME    - Your DockerHub username (do not hardcode sensitive information)"
	@echo "  TAG                - Image tag (default: latest)"
```

`make all`ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§linux/amd64ç”¨ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨Docker Hubã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ãŒè¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

####

### Agent ã‚’APIçµŒç”±ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

### Agent Kitã®DockeråŒ–

ã“ã“ã§ã¯ã€Agent Kitã‚’åˆ©ç”¨ã—ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’
Dockerã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–ã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚
Autonomeã¯Dockerã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```dockerfile
# Node.js 18-slimã‚’ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ä½¿ç”¨ã—ã¾ã™ã€‚
FROM node:18-slim

# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ /app ã«è¨­å®šã—ã¾ã™ã€‚
WORKDIR /app

# ä¾å­˜é–¢ä¿‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ˆã«ã‚³ãƒ”ãƒ¼ã—ã€npm ciã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
COPY package.json package-lock.json ./
RUN npm ci

# æ®‹ã‚Šã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
COPY . .

# TypeScriptã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚å‡ºåŠ›ã¯ dist ã«é…ç½®ã•ã‚Œã¾ã™ã€‚
RUN npm run build

# PORTã¯3000ã«è¨­å®šã—ã¾ã™ã€‚
ENV PORT=3000

# ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã« entrypoint.sh ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ENTRYPOINT ["./entrypoint.sh"]
```

æ¬¡ã«ã€åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«**entrypoint.sh**ã‚’ç”¨æ„ã—ã¾ã™ã€‚

```bash
#!/bin/sh
# entrypoint.sh

# å¿…é ˆã®ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
if [ -z "$OPENAI_API_KEY" ] || [ -z "$CDP_API_KEY" ] || [ -z "$WALLET_PRIVATE_KEY" ]; then
  echo "Error: å¿…é ˆã®APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
  exit 1
fi

# npm startã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚
npm run start
```

â€»ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä¸ãˆã¦ãã ã•ã„ï¼ˆä¾‹: `chmod +x entrypoint.sh`ï¼‰ã€‚

ã“ã‚Œã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
docker build --platform linux/amd64 -t myagent:latest .
```

ãƒ“ãƒ«ãƒ‰å®Œäº†å¾Œã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã—å‹•ä½œç¢ºèªã—ã¦ãã ã•ã„ã€‚

```bash
docker run -p 3000:3000 \
  -e OPENAI_API_KEY=<OpenAIã‚­ãƒ¼> \
  -e CDP_API_KEY=<CDPã‚­ãƒ¼> \
  -e WALLET_PRIVATE_KEY=<ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç§˜å¯†éµ> \
  myagent:latest
```

ãƒ–ãƒ©ã‚¦ã‚¶ã¾ãŸã¯curlã§`http://localhost:3000/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—
"OK"ãŒè¿”ã‚Œã°æˆåŠŸã§ã™ã€‚
ã¾ãŸã€`POST /chat`ã«å¯¾ã—ã¦JSONã‚’é€ä¿¡ã—å¿œç­”ãŒè¿”ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### Autonomeã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

æ¬¡ã«ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Autonomeã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚
å¤§ã¾ã‹ãªæ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

1. **ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒƒã‚·ãƒ¥**
   Docker Hubãªã©ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ã€
   `myagent:latest`ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚
   ä¾‹: `username/myagent:latest`
2. **Autonomeã§æ–°è¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½œæˆ**
   ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã€Œ+ æ–°è¦ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‹ã‚‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½œæˆç”»é¢ã¸é€²ã¿ã¾ã™ã€‚
   ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåã‚„èª¬æ˜ã‚’å…¥åŠ›ã—ã€**AgentKit**ã‚¹ã‚¿ãƒƒã‚¯ã‚’é¸æŠã—ã¾ã™ã€‚
   ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸åã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
3. **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**
   UIä¸Šã§`OPENAI_API_KEY`ã‚„`CDP_API_KEY`ã€`WALLET_PRIVATE_KEY`ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
4. **ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ**
   ãƒ‡ãƒ—ãƒ­ã‚¤ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã™ã‚‹ã®ã‚’å¾…ã¡ã¾ã™ã€‚
   æ•°åˆ†å¾Œã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¾ã™ã€‚

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€Autonomeã®UIã‹ã‚‰
ã€ŒChat with Agentã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å¯¾è©±ã‚’é–‹å§‹ã§ãã¾ã™ã€‚
ãªãŠã€ä¸€åº¦ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯
ãã®å ´ã§ç·¨é›†ã§ãã¾ã›ã‚“ã€‚å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€
æ–°ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã ã•ã„ã€‚

ã¾ãŸã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­å®šã‚‚é‡è¦ã§ã™ã€‚
å¿…ãš`POST /chat`ã‚„`GET /`ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
ç‰¹ã«ã€ã‚µãƒ¼ãƒã¯0.0.0.0ã§å¾…æ©Ÿã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## ãƒãƒã£ãŸãƒã‚¤ãƒ³ãƒˆã¨å›é¿ç­–

æœ€å¾Œã«ã€ç­†è€…ãŒå®Ÿéš›ã«Autonomeï¼‹AgentKitç’°å¢ƒã‚’è§¦ã£ã¦ã¿ã¦ãƒãƒã£ãŸãƒã‚¤ãƒ³ãƒˆã¨ãã®å›é¿ç­–ã‚’å…±æœ‰ã—ã¾ã™ã€‚

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

Autonomeã§ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã®ç¨¼åƒç›£è¦–ã®ãŸã‚ã«healthzã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚Šãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦ã™ãã«200ã‚’è¿”ã™å®Ÿè£…ã«ã—ã¦ãã ã•ã„ã€‚

### exec /usr/local/bin/docker-entrypoint.sh: exec format error`

Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä¸­ã«docker-entrypoint.shã‚’é…ç½®ã—ã¦ã‚ã’ã¦0ãªã‚Šã‚’ãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### Apple Silicon Macã§ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰

Apple Siliconã®Macã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚‚Autonomeä¸Šã§å‹•ã‹ãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚docker build --platform linux/amd64 -t <ã‚¿ã‚°å> .ã¨ã—ã¦ä¸Šã’ã‚‹ã¨å›é¿ã§ãã¾ã™ã€‚

## ã‚³ãƒ¼ãƒ‰ã¨å‚è€ƒãƒªãƒ³ã‚¯

#### ã‚³ãƒ¼ãƒ‰

æœ€å¾Œã«ã€ä»Šå›è§£èª¬ã—ãŸã‚³ãƒ¼ãƒ‰ä¸€å¼ã¯GitHubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚ã‚Šã¾ã™ [autonome-coinbase-agentkit-integration](https://github.com/susumutomita/autonome-coinbase-agentkit-integration)

#### å‚è€ƒãƒªãƒ³ã‚¯é›†

- [AltLayerå…¬å¼: Autonomeãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.altlayer.io/altlayer-documentation/autonome/deploy-ai-agent)
- [Introducing AgentKit | Coinbase](https://www.coinbase.com/developer-platform/discover/launches/introducing-agentkit)
- [Coinbase Developer Docs: AgentKit](https://docs.cdp.coinbase.com/agentkit/docs/welcome)
- [Coinbase GitHub](https://github.com/coinbase/agentkit)
